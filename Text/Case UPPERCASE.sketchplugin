for (var i = 0; i < selection.length(); i++) {
  var s = selection[i]

  if([s class] === MSTextLayer){
    var new_text = [s stringValue].toUpperCase();
    [s setStringValue:new_text]
    [s markLayerDirty]
  }
}